(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[814],{8012:function(e,t,r){Promise.resolve().then(r.bind(r,5357)),Promise.resolve().then(r.bind(r,2611)),Promise.resolve().then(r.bind(r,3608))},5357:function(e,t,r){"use strict";r.d(t,{ChatBot:function(){return c}});var n=r(7437),s=r(2265),o=r(9376),a=r(9116),i=r(7996);function c(){let[e,t]=(0,s.useState)(!1),[r,c]=(0,s.useState)([{role:"assistant",content:"\uD83D\uDC4B Hi! I'm your nutrition assistant. Ask me anything about food and nutrition!"}]),[l,u]=(0,s.useState)(!1),[d,h]=(0,s.useState)(""),[f,m]=(0,s.useState)(!1),g=(0,s.useRef)(null),x=(0,s.useRef)(null),p=(0,o.useRouter)(),y=()=>{var e;null===(e=g.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})};(0,s.useEffect)(()=>{y()},[r]),(0,s.useEffect)(()=>{e&&x.current&&x.current.focus()},[e]);let b=async e=>{if(e.preventDefault(),!d.trim()||f)return;let t=d.trim();h(""),u(!0);let n=r.filter((e,t)=>t>0).map(e=>({role:e.role,content:e.content})),s=[...r,{role:"user",content:t}];c(s),m(!0);try{var o,i;let e=await a.h.sendChatMessage(t,n),r=null!==(i=null!==(o=e.reply)&&void 0!==o?o:e.Reply)&&void 0!==i?i:"";if(r&&r.trim())c([...s,{role:"assistant",content:r}]);else throw Error("Empty response")}catch(e){console.error("Chat error:",e),c([...s,{role:"assistant",content:"Sorry, something went wrong. Please try again."}])}finally{m(!1)}},v=e=>{"log"===e?(p.push("/log"),t(!1)):"foods"===e&&(p.push("/foods"),t(!1))};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{onClick:()=>t(!e),className:"fixed bottom-6 right-6 z-50 p-4 rounded-full shadow-lg transition-all duration-300 ".concat(e?"bg-gray-600 hover:bg-gray-700":"bg-primary-600 hover:bg-primary-700 animate-pulse"),"aria-label":e?"Close chat":"Open chat",children:e?(0,n.jsx)(i.q5L,{className:"w-6 h-6 text-white"}):(0,n.jsx)(i.EQ9,{className:"w-6 h-6 text-white"})}),e&&(0,n.jsxs)("div",{className:"fixed bottom-24 right-6 z-50 w-96 max-w-[calc(100vw-3rem)] bg-white rounded-2xl shadow-2xl border border-gray-200 flex flex-col overflow-hidden",children:[(0,n.jsxs)("div",{className:"bg-primary-600 text-white p-4",children:[(0,n.jsx)("h3",{className:"font-semibold flex items-center gap-2",children:"\uD83E\uDD16 Nutrition Assistant"}),(0,n.jsx)("p",{className:"text-sm text-primary-100",children:"Ask me anything about food & nutrition"})]}),(0,n.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 max-h-96 min-h-64 bg-gray-50",children:[r.map((e,t)=>(0,n.jsx)("div",{className:"flex ".concat("user"===e.role?"justify-end":"justify-start"),children:(0,n.jsx)("div",{className:"max-w-[80%] p-3 rounded-2xl ".concat("user"===e.role?"bg-primary-600 text-white rounded-br-md":"bg-white text-gray-800 rounded-bl-md shadow-sm border border-gray-100"),children:(0,n.jsx)("div",{className:"text-sm whitespace-pre-wrap",children:e.content})})},t)),f&&(0,n.jsx)("div",{className:"flex justify-start",children:(0,n.jsx)("div",{className:"bg-white p-3 rounded-2xl rounded-bl-md shadow-sm border border-gray-100",children:(0,n.jsx)(i.dAq,{className:"w-5 h-5 animate-spin text-primary-600"})})}),(0,n.jsx)("div",{ref:g})]}),(0,n.jsxs)("div",{className:"px-4 py-2 bg-gray-50 border-t border-gray-100 flex gap-2",children:[(0,n.jsx)("button",{onClick:()=>v("log"),className:"text-xs px-3 py-1.5 bg-green-100 text-green-700 rounded-full hover:bg-green-200 transition-colors",children:"+ Log Meal"}),(0,n.jsx)("button",{onClick:()=>v("foods"),className:"text-xs px-3 py-1.5 bg-blue-100 text-blue-700 rounded-full hover:bg-blue-200 transition-colors",children:"View Foods"})]}),(0,n.jsx)("form",{onSubmit:b,className:"p-4 border-t border-gray-200 bg-white",children:(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)("input",{ref:x,type:"text",value:d,onChange:e=>h(e.target.value),placeholder:"Ask about nutrition...",className:"flex-1 px-4 py-2 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent text-sm",disabled:f}),(0,n.jsx)("button",{type:"submit",disabled:f||!d.trim(),className:"p-2 bg-primary-600 text-white rounded-full hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:(0,n.jsx)(i.LbG,{className:"w-5 h-5"})})]})})]})]})}},2611:function(e,t,r){"use strict";r.d(t,{Navbar:function(){return c}});var n=r(7437),s=r(7648),o=r(2265),a=r(9179),i=r(7996);function c(){var e;let{user:t,logout:r,isAuthenticated:c}=(0,a.a)(),[d,h]=(0,o.useState)(!1),f=(0,o.useRef)(null);if((0,o.useEffect)(()=>{function e(e){f.current&&!f.current.contains(e.target)&&h(!1)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),!c)return null;let m=()=>{var e,r,n;return t&&((((null===(e=t.firstName)||void 0===e?void 0:e.charAt(0))||"")+((null===(r=t.lastName)||void 0===r?void 0:r.charAt(0))||"")).toUpperCase()||(null===(n=t.email)||void 0===n?void 0:n.charAt(0).toUpperCase()))||"?"};return(0,n.jsxs)("nav",{className:"bg-white border-b border-gray-200 sticky top-0 z-50",children:[(0,n.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,n.jsxs)("div",{className:"flex justify-between h-16",children:[(0,n.jsxs)("div",{className:"flex items-center gap-8",children:[(0,n.jsx)(s.default,{href:"/",className:"flex items-center gap-2 text-primary-600 font-bold text-xl",children:"\uD83C\uDF4E Calorie Calculator"}),(0,n.jsxs)("div",{className:"hidden md:flex items-center gap-1",children:[(0,n.jsx)(l,{href:"/",icon:(0,n.jsx)(i.m6D,{}),label:"Dashboard"}),(0,n.jsx)(l,{href:"/foods",icon:(0,n.jsx)(i.SnF,{}),label:"Foods"}),(0,n.jsx)(l,{href:"/log",icon:(0,n.jsx)(i.O9D,{}),label:"Log Meal"})]})]}),(0,n.jsxs)("div",{className:"flex items-center gap-3",ref:f,children:[(0,n.jsxs)("button",{onClick:()=>h(!d),className:"flex items-center gap-2 px-2 py-1.5 rounded-full hover:bg-gray-100 transition-colors",children:[(null==t?void 0:t.profilePicture)?(0,n.jsx)("img",{src:t.profilePicture,alt:"Profile",className:"w-9 h-9 rounded-full object-cover shadow-md ring-2 ring-white"}):(0,n.jsx)("div",{className:"w-9 h-9 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white font-semibold text-sm shadow-md",children:m()}),(0,n.jsx)("span",{className:"hidden sm:block font-medium text-gray-800 max-w-[120px] truncate",children:t?t.firstName?t.firstName:(null===(e=t.email)||void 0===e?void 0:e.split("@")[0])||"":""}),(0,n.jsx)(i.bTu,{className:"w-4 h-4 text-gray-500 transition-transform ".concat(d?"rotate-180":"")})]}),d&&(0,n.jsxs)("div",{className:"absolute right-4 top-14 w-72 bg-white rounded-xl shadow-xl border border-gray-100 py-2 animate-in fade-in slide-in-from-top-2 duration-200",children:[(0,n.jsx)("div",{className:"px-4 py-3 border-b border-gray-100",children:(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(null==t?void 0:t.profilePicture)?(0,n.jsx)("img",{src:t.profilePicture,alt:"Profile",className:"w-12 h-12 rounded-full object-cover shadow-md ring-2 ring-white"}):(0,n.jsx)("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white font-bold text-lg shadow-md",children:m()}),(0,n.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,n.jsx)("p",{className:"font-semibold text-gray-900 truncate",children:(null==t?void 0:t.fullName)||"".concat(null==t?void 0:t.firstName," ").concat(null==t?void 0:t.lastName)}),(0,n.jsx)("p",{className:"text-sm text-gray-500 truncate",children:null==t?void 0:t.email})]})]})}),(0,n.jsx)("div",{className:"py-1",children:(0,n.jsxs)(s.default,{href:"/settings",onClick:()=>h(!1),className:"flex items-center gap-3 px-4 py-2.5 text-gray-700 hover:bg-gray-50 transition-colors",children:[(0,n.jsx)("div",{className:"w-9 h-9 rounded-full bg-gray-100 flex items-center justify-center",children:(0,n.jsx)(i.nbt,{className:"w-5 h-5 text-gray-600"})}),(0,n.jsx)("span",{className:"font-medium",children:"Settings & Privacy"})]})}),(0,n.jsx)("div",{className:"border-t border-gray-100 pt-1",children:(0,n.jsxs)("button",{onClick:()=>{h(!1),r()},className:"flex items-center gap-3 w-full px-4 py-2.5 text-gray-700 hover:bg-gray-50 transition-colors",children:[(0,n.jsx)("div",{className:"w-9 h-9 rounded-full bg-gray-100 flex items-center justify-center",children:(0,n.jsx)(i.xqh,{className:"w-5 h-5 text-gray-600"})}),(0,n.jsx)("span",{className:"font-medium",children:"Log Out"})]})})]})]})]})}),(0,n.jsx)("div",{className:"md:hidden border-t border-gray-100",children:(0,n.jsxs)("div",{className:"flex justify-around py-2",children:[(0,n.jsx)(u,{href:"/",icon:(0,n.jsx)(i.m6D,{}),label:"Dashboard"}),(0,n.jsx)(u,{href:"/foods",icon:(0,n.jsx)(i.SnF,{}),label:"Foods"}),(0,n.jsx)(u,{href:"/log",icon:(0,n.jsx)(i.O9D,{}),label:"Log"})]})})]})}function l(e){let{href:t,icon:r,label:o}=e;return(0,n.jsxs)(s.default,{href:t,className:"flex items-center gap-2 px-4 py-2 text-gray-600 hover:text-primary-600 hover:bg-primary-50 rounded-lg transition-colors",children:[r,(0,n.jsx)("span",{children:o})]})}function u(e){let{href:t,icon:r,label:o}=e;return(0,n.jsxs)(s.default,{href:t,className:"flex flex-col items-center gap-1 px-4 py-1 text-gray-600 hover:text-primary-600",children:[r,(0,n.jsx)("span",{className:"text-xs",children:o})]})}},3608:function(e,t,r){"use strict";r.d(t,{ProtectedRoute:function(){return i}});var n=r(7437),s=r(2265),o=r(9376),a=r(9179);function i(e){let{children:t}=e,{isAuthenticated:r,isLoading:i}=(0,a.a)(),c=(0,o.useRouter)();return((0,s.useEffect)(()=>{i||r||c.push("/auth/login")},[r,i,c]),i)?(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):r?(0,n.jsx)(n.Fragment,{children:t}):null}},9116:function(e,t,r){"use strict";r.d(t,{h:function(){return a}});var n=r(4131);let s=r(257).env.NEXT_PUBLIC_API_URL||"http://localhost:5000/api";class o{getToken(){return n.Z.get("token")}async request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.getToken(),n={"Content-Type":"application/json",...r&&{Authorization:"Bearer ".concat(r)},...t.headers},o=await fetch("".concat(s).concat(e),{...t,headers:n,credentials:"include"});if(!o.ok)throw Error((await o.json().catch(()=>({}))).message||"HTTP error! status: ".concat(o.status));return 204===o.status?{}:o.json()}async register(e){return this.request("/auth/register",{method:"POST",body:JSON.stringify(e)})}async login(e,t){return this.request("/auth/login",{method:"POST",body:JSON.stringify({email:e,password:t})})}async getCurrentUser(){return this.request("/auth/me")}async getFoods(){return this.request("/foods")}async getFood(e){return this.request("/foods/".concat(e))}async createFood(e){return this.request("/foods",{method:"POST",body:JSON.stringify(e)})}async updateFood(e,t){return this.request("/foods/".concat(e),{method:"PUT",body:JSON.stringify(t)})}async deleteFood(e){return this.request("/foods/".concat(e),{method:"DELETE"})}async getEntries(e){return this.request("/food-entries".concat(e?"?date=".concat(e):""))}async createEntry(e){return this.request("/food-entries",{method:"POST",body:JSON.stringify(e)})}async updateEntry(e,t){return this.request("/food-entries/".concat(e),{method:"PUT",body:JSON.stringify(t)})}async deleteEntry(e){return this.request("/food-entries/".concat(e),{method:"DELETE"})}async getDailyMetrics(e){return this.request("/metrics/daily".concat(e?"?date=".concat(e):""))}async getRangeMetrics(e,t){return this.request("/metrics/range?from=".concat(e,"&to=").concat(t))}async sendChatMessage(e,t){let r=null==t?void 0:t.map(e=>({sender:e.role,text:e.content}));return this.request("/chat",{method:"POST",body:JSON.stringify({message:e,history:r})})}async getGoals(){return this.request("/auth/goals")}async updateGoals(e){return this.request("/auth/goals",{method:"PUT",body:JSON.stringify(e)})}async updateProfile(e){return this.request("/auth/profile",{method:"PUT",body:JSON.stringify(e)})}async changePassword(e,t){return this.request("/auth/change-password",{method:"PUT",body:JSON.stringify({currentPassword:e,newPassword:t})})}async deleteAccount(){return this.request("/auth/account",{method:"DELETE"})}async uploadProfilePicture(e){return this.request("/auth/profile-picture",{method:"POST",body:JSON.stringify({imageData:e})})}async removeProfilePicture(){return this.request("/auth/profile-picture",{method:"DELETE"})}async analyzeFood(e){let t=new FormData;t.append("image",e);let r=this.getToken(),n=await fetch("".concat(s,"/image-recognition/analyze"),{method:"POST",headers:{...r&&{Authorization:"Bearer ".concat(r)}},body:t,credentials:"include"});if(!n.ok)throw Error((await n.json().catch(()=>({}))).message||"HTTP error! status: ".concat(n.status));return n.json()}async analyzeRecipe(e,t){return this.request("/recipe/analyze",{method:"POST",body:JSON.stringify({recipeText:e,servings:t})})}async getWaterSummary(e){return this.request("/water/summary".concat(e?"?date=".concat(e):""))}async logWater(e,t){return this.request("/water/log",{method:"POST",body:JSON.stringify({milliliters:e,date:t})})}async deleteWaterEntry(e){return this.request("/water/".concat(e),{method:"DELETE"})}async getFavoriteMeals(){return this.request("/favorite-meals")}async createFavoriteMeal(e){return this.request("/favorite-meals",{method:"POST",body:JSON.stringify(e)})}async deleteFavoriteMeal(e){return this.request("/favorite-meals/".concat(e),{method:"DELETE"})}async getFavoriteMealItems(e){return this.request("/favorite-meals/".concat(e,"/items"))}async getFoodSuggestions(e){return this.request("/suggestions".concat(e?"?date=".concat(e):""))}}let a=new o},9179:function(e,t,r){"use strict";r.d(t,{H:function(){return l},a:function(){return u}});var n=r(7437),s=r(2265),o=r(9376),a=r(4131),i=r(9116);let c=(0,s.createContext)(void 0);function l(e){let{children:t}=e,[r,l]=(0,s.useState)(null),[u,d]=(0,s.useState)(!0),h=(0,o.useRouter)(),f=(0,s.useCallback)(async()=>{if(!a.Z.get("token")){d(!1);return}try{let e=await i.h.getCurrentUser();l(e)}catch(e){a.Z.remove("token")}finally{d(!1)}},[]);(0,s.useEffect)(()=>{f()},[f]);let m=async(e,t)=>{let r=await i.h.login(e,t);a.Z.set("token",r.token,{expires:7}),l(r.user),h.push("/")},g=async e=>{let t=await i.h.register(e);a.Z.set("token",t.token,{expires:7}),l(t.user),h.push("/")},x=async()=>{try{let e=await i.h.getCurrentUser();l(e)}catch(e){}};return(0,n.jsx)(c.Provider,{value:{user:r,isLoading:u,isAuthenticated:!!r,login:m,register:g,logout:()=>{a.Z.remove("token"),l(null),h.push("/auth/login")},refreshUser:x},children:t})}function u(){let e=(0,s.useContext)(c);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},9376:function(e,t,r){"use strict";var n=r(5475);r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}})},257:function(e,t,r){"use strict";var n,s;e.exports=(null==(n=r.g.process)?void 0:n.env)&&"object"==typeof(null==(s=r.g.process)?void 0:s.env)?r.g.process:r(4227)},4227:function(e){!function(){var t={229:function(e){var t,r,n,s=e.exports={};function o(){throw Error("setTimeout has not been defined")}function a(){throw Error("clearTimeout has not been defined")}function i(e){if(t===setTimeout)return setTimeout(e,0);if((t===o||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:o}catch(e){t=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var c=[],l=!1,u=-1;function d(){l&&n&&(l=!1,n.length?c=n.concat(c):u=-1,c.length&&h())}function h(){if(!l){var e=i(d);l=!0;for(var t=c.length;t;){for(n=c,c=[];++u<t;)n&&n[u].run();u=-1,t=c.length}n=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function m(){}s.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new f(e,t)),1!==c.length||l||i(h)},f.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=m,s.addListener=m,s.once=m,s.off=m,s.removeListener=m,s.removeAllListeners=m,s.emit=m,s.prependListener=m,s.prependOnceListener=m,s.listeners=function(e){return[]},s.binding=function(e){throw Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw Error("process.chdir is not supported")},s.umask=function(){return 0}}},r={};function n(e){var s=r[e];if(void 0!==s)return s.exports;var o=r[e]={exports:{}},a=!0;try{t[e](o,o.exports,n),a=!1}finally{a&&delete r[e]}return o.exports}n.ab="//";var s=n(229);e.exports=s}()},4131:function(e,t,r){"use strict";function n(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)e[n]=r[n]}return e}r.d(t,{Z:function(){return s}});var s=function e(t,r){function s(e,s,o){if("undefined"!=typeof document){"number"==typeof(o=n({},r,o)).expires&&(o.expires=new Date(Date.now()+864e5*o.expires)),o.expires&&(o.expires=o.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var a="";for(var i in o)o[i]&&(a+="; "+i,!0!==o[i]&&(a+="="+o[i].split(";")[0]));return document.cookie=e+"="+t.write(s,e)+a}}return Object.create({set:s,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var r=document.cookie?document.cookie.split("; "):[],n={},s=0;s<r.length;s++){var o=r[s].split("="),a=o.slice(1).join("=");try{var i=decodeURIComponent(o[0]);if(n[i]=t.read(a,i),e===i)break}catch(e){}}return e?n[e]:n}},remove:function(e,t){s(e,"",n({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,n({},this.attributes,t))},withConverter:function(t){return e(n({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(r)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"})}},function(e){e.O(0,[956,599,971,117,744],function(){return e(e.s=8012)}),_N_E=e.O()}]);