(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[455],{3641:function(e,t,r){Promise.resolve().then(r.bind(r,5849))},5849:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return f}});var s=r(7437),a=r(2265),n=r(9179),o=r(9376),i=r(9501),l=r(3590),c=r(7119),u=r(7996),d=r(9116),m=r(9827);let h=c.Ry({calorieGoal:c.oQ.number().min(500,"Min 500 kcal").max(1e4,"Max 10000 kcal"),proteinGoal:c.oQ.number().min(10,"Min 10g").max(500,"Max 500g"),carbsGoal:c.oQ.number().min(20,"Min 20g").max(800,"Max 800g"),fatGoal:c.oQ.number().min(10,"Min 10g").max(300,"Max 300g")});function f(){let{user:e}=(0,n.a)(),t=(0,o.useRouter)(),r=(0,m.NL)(),[c,f]=(0,a.useState)(!1),[y,g]=(0,a.useState)(""),[x,p]=(0,a.useState)(""),{register:b,handleSubmit:v,reset:j,watch:N,formState:{errors:w,isDirty:O}}=(0,i.cI)({resolver:(0,l.F)(h),defaultValues:{calorieGoal:(null==e?void 0:e.calorieGoal)||2e3,proteinGoal:(null==e?void 0:e.proteinGoal)||150,carbsGoal:(null==e?void 0:e.carbsGoal)||250,fatGoal:(null==e?void 0:e.fatGoal)||65}});(0,a.useEffect)(()=>{e&&j({calorieGoal:e.calorieGoal||2e3,proteinGoal:e.proteinGoal||150,carbsGoal:e.carbsGoal||250,fatGoal:e.fatGoal||65})},[e,j]);let G=N(),P=(()=>{let e=4*(G.proteinGoal||0)+4*(G.carbsGoal||0)+9*(G.fatGoal||0);return 0===e?{protein:0,carbs:0,fat:0}:{protein:Math.round(4*(G.proteinGoal||0)/e*100),carbs:Math.round(4*(G.carbsGoal||0)/e*100),fat:Math.round(9*(G.fatGoal||0)/e*100)}})(),E=async e=>{f(!0),p(""),g("");try{await d.h.updateGoals(e),r.invalidateQueries({queryKey:["user"]}),r.invalidateQueries({queryKey:["metrics"]}),g("Goals updated successfully!"),setTimeout(()=>g(""),3e3)}catch(e){p(e instanceof Error?e.message:"Failed to update goals")}finally{f(!1)}};return(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)("div",{className:"bg-white border-b border-gray-200 sticky top-16 z-40",children:(0,s.jsxs)("div",{className:"max-w-2xl mx-auto px-4 py-4 flex items-center gap-4",children:[(0,s.jsx)("button",{onClick:()=>t.back(),className:"p-2 -ml-2 hover:bg-gray-100 rounded-full transition-colors",children:(0,s.jsx)(u.Ao2,{className:"w-6 h-6 text-gray-700"})}),(0,s.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"Nutrition Goals"})]})}),(0,s.jsxs)("div",{className:"max-w-2xl mx-auto px-4 py-6 space-y-6",children:[y&&(0,s.jsxs)("div",{className:"p-4 bg-green-50 border border-green-200 text-green-700 rounded-xl flex items-center gap-3",children:[(0,s.jsx)(u.UgA,{className:"w-5 h-5"}),y]}),x&&(0,s.jsx)("div",{className:"p-4 bg-red-50 border border-red-200 text-red-700 rounded-xl",children:x}),(0,s.jsxs)("div",{className:"bg-gradient-to-r from-purple-500 to-indigo-600 rounded-xl p-6 text-white",children:[(0,s.jsx)("h2",{className:"font-semibold text-lg mb-4",children:"Macro Distribution"}),(0,s.jsxs)("div",{className:"flex gap-2 mb-3",children:[(0,s.jsx)("div",{className:"h-3 bg-green-400 rounded-full transition-all",style:{width:"".concat(P.protein,"%")}}),(0,s.jsx)("div",{className:"h-3 bg-yellow-400 rounded-full transition-all",style:{width:"".concat(P.carbs,"%")}}),(0,s.jsx)("div",{className:"h-3 bg-red-400 rounded-full transition-all",style:{width:"".concat(P.fat,"%")}})]}),(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsxs)("span",{className:"flex items-center gap-1",children:[(0,s.jsx)("span",{className:"w-2 h-2 bg-green-400 rounded-full"}),"Protein ",P.protein,"%"]}),(0,s.jsxs)("span",{className:"flex items-center gap-1",children:[(0,s.jsx)("span",{className:"w-2 h-2 bg-yellow-400 rounded-full"}),"Carbs ",P.carbs,"%"]}),(0,s.jsxs)("span",{className:"flex items-center gap-1",children:[(0,s.jsx)("span",{className:"w-2 h-2 bg-red-400 rounded-full"}),"Fat ",P.fat,"%"]})]})]}),(0,s.jsxs)("form",{onSubmit:v(E),className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[(0,s.jsxs)("div",{className:"p-4 border-b border-gray-100",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Daily Goals"}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Set your daily nutrition targets"})]}),(0,s.jsxs)("div",{className:"p-6 space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 mb-2",children:[(0,s.jsx)(u.xUG,{className:"w-4 h-4 text-indigo-600"}),"Daily Calorie Goal"]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("input",{...b("calorieGoal"),type:"number",className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all"}),(0,s.jsx)("span",{className:"text-gray-500 font-medium",children:"kcal"})]}),w.calorieGoal&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:w.calorieGoal.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 mb-2",children:[(0,s.jsx)("span",{className:"w-4 h-4 rounded-full bg-green-500"}),"Protein Goal"]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("input",{...b("proteinGoal"),type:"number",className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all"}),(0,s.jsx)("span",{className:"text-gray-500 font-medium",children:"g"})]}),w.proteinGoal&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:w.proteinGoal.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 mb-2",children:[(0,s.jsx)(u.Wqx,{className:"w-4 h-4 text-yellow-500"}),"Carbs Goal"]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("input",{...b("carbsGoal"),type:"number",className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-yellow-500 focus:border-transparent transition-all"}),(0,s.jsx)("span",{className:"text-gray-500 font-medium",children:"g"})]}),w.carbsGoal&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:w.carbsGoal.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 mb-2",children:[(0,s.jsx)(u.YF6,{className:"w-4 h-4 text-red-500"}),"Fat Goal"]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("input",{...b("fatGoal"),type:"number",className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all"}),(0,s.jsx)("span",{className:"text-gray-500 font-medium",children:"g"})]}),w.fatGoal&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:w.fatGoal.message})]})]}),(0,s.jsx)("div",{className:"p-4 bg-gray-50 border-t border-gray-100",children:(0,s.jsx)("button",{type:"submit",disabled:c||!O,className:"w-full py-3 px-4 bg-purple-600 text-white font-semibold rounded-xl hover:bg-purple-700 focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:c?"Saving...":"Save Goals"})})]})]})]})}},9116:function(e,t,r){"use strict";r.d(t,{h:function(){return o}});var s=r(4131);let a=r(257).env.NEXT_PUBLIC_API_URL||"http://localhost:5000/api";class n{getToken(){return s.Z.get("token")}async request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.getToken(),s={"Content-Type":"application/json",...r&&{Authorization:"Bearer ".concat(r)},...t.headers},n=await fetch("".concat(a).concat(e),{...t,headers:s,credentials:"include"});if(!n.ok)throw Error((await n.json().catch(()=>({}))).message||"HTTP error! status: ".concat(n.status));return 204===n.status?{}:n.json()}async register(e){return this.request("/auth/register",{method:"POST",body:JSON.stringify(e)})}async login(e,t){return this.request("/auth/login",{method:"POST",body:JSON.stringify({email:e,password:t})})}async getCurrentUser(){return this.request("/auth/me")}async getFoods(){return this.request("/foods")}async getFood(e){return this.request("/foods/".concat(e))}async createFood(e){return this.request("/foods",{method:"POST",body:JSON.stringify(e)})}async updateFood(e,t){return this.request("/foods/".concat(e),{method:"PUT",body:JSON.stringify(t)})}async deleteFood(e){return this.request("/foods/".concat(e),{method:"DELETE"})}async getEntries(e){return this.request("/food-entries".concat(e?"?date=".concat(e):""))}async createEntry(e){return this.request("/food-entries",{method:"POST",body:JSON.stringify(e)})}async updateEntry(e,t){return this.request("/food-entries/".concat(e),{method:"PUT",body:JSON.stringify(t)})}async deleteEntry(e){return this.request("/food-entries/".concat(e),{method:"DELETE"})}async getDailyMetrics(e){return this.request("/metrics/daily".concat(e?"?date=".concat(e):""))}async getRangeMetrics(e,t){return this.request("/metrics/range?from=".concat(e,"&to=").concat(t))}async sendChatMessage(e,t){let r=null==t?void 0:t.map(e=>({sender:e.role,text:e.content}));return this.request("/chat",{method:"POST",body:JSON.stringify({message:e,history:r})})}async getGoals(){return this.request("/auth/goals")}async updateGoals(e){return this.request("/auth/goals",{method:"PUT",body:JSON.stringify(e)})}async updateProfile(e){return this.request("/auth/profile",{method:"PUT",body:JSON.stringify(e)})}async changePassword(e,t){return this.request("/auth/change-password",{method:"PUT",body:JSON.stringify({currentPassword:e,newPassword:t})})}async deleteAccount(){return this.request("/auth/account",{method:"DELETE"})}async uploadProfilePicture(e){return this.request("/auth/profile-picture",{method:"POST",body:JSON.stringify({imageData:e})})}async removeProfilePicture(){return this.request("/auth/profile-picture",{method:"DELETE"})}async analyzeFood(e){let t=new FormData;t.append("image",e);let r=this.getToken(),s=await fetch("".concat(a,"/image-recognition/analyze"),{method:"POST",headers:{...r&&{Authorization:"Bearer ".concat(r)}},body:t,credentials:"include"});if(!s.ok)throw Error((await s.json().catch(()=>({}))).message||"HTTP error! status: ".concat(s.status));return s.json()}async analyzeRecipe(e,t){return this.request("/recipe/analyze",{method:"POST",body:JSON.stringify({recipeText:e,servings:t})})}async getWaterSummary(e){return this.request("/water/summary".concat(e?"?date=".concat(e):""))}async logWater(e,t){return this.request("/water/log",{method:"POST",body:JSON.stringify({milliliters:e,date:t})})}async deleteWaterEntry(e){return this.request("/water/".concat(e),{method:"DELETE"})}async getFavoriteMeals(){return this.request("/favorite-meals")}async createFavoriteMeal(e){return this.request("/favorite-meals",{method:"POST",body:JSON.stringify(e)})}async deleteFavoriteMeal(e){return this.request("/favorite-meals/".concat(e),{method:"DELETE"})}async getFavoriteMealItems(e){return this.request("/favorite-meals/".concat(e,"/items"))}async getFoodSuggestions(e){return this.request("/suggestions".concat(e?"?date=".concat(e):""))}}let o=new n},9179:function(e,t,r){"use strict";r.d(t,{H:function(){return c},a:function(){return u}});var s=r(7437),a=r(2265),n=r(9376),o=r(4131),i=r(9116);let l=(0,a.createContext)(void 0);function c(e){let{children:t}=e,[r,c]=(0,a.useState)(null),[u,d]=(0,a.useState)(!0),m=(0,n.useRouter)(),h=(0,a.useCallback)(async()=>{if(!o.Z.get("token")){d(!1);return}try{let e=await i.h.getCurrentUser();c(e)}catch(e){o.Z.remove("token")}finally{d(!1)}},[]);(0,a.useEffect)(()=>{h()},[h]);let f=async(e,t)=>{let r=await i.h.login(e,t);o.Z.set("token",r.token,{expires:7}),c(r.user),m.push("/")},y=async e=>{let t=await i.h.register(e);o.Z.set("token",t.token,{expires:7}),c(t.user),m.push("/")},g=async()=>{try{let e=await i.h.getCurrentUser();c(e)}catch(e){}};return(0,s.jsx)(l.Provider,{value:{user:r,isLoading:u,isAuthenticated:!!r,login:f,register:y,logout:()=>{o.Z.remove("token"),c(null),m.push("/auth/login")},refreshUser:g},children:t})}function u(){let e=(0,a.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},9376:function(e,t,r){"use strict";var s=r(5475);r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}})},9827:function(e,t,r){"use strict";r.d(t,{NL:function(){return o},aH:function(){return i}});var s=r(2265),a=r(7437),n=s.createContext(void 0),o=e=>{let t=s.useContext(n);if(e)return e;if(!t)throw Error("No QueryClient set, use QueryClientProvider to set one");return t},i=e=>{let{client:t,children:r}=e;return s.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),(0,a.jsx)(n.Provider,{value:t,children:r})}},6231:function(e,t,r){"use strict";r.d(t,{w_:function(){return u}});var s=r(2265),a={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},n=s.createContext&&s.createContext(a),o=["attr","size","title"];function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e}).apply(this,arguments)}function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach(function(t){var s,a;s=t,a=r[t],(s=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t||"default");if("object"!=typeof s)return s;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(s))in e?Object.defineProperty(e,s,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[s]=a}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function u(e){return t=>s.createElement(d,i({attr:c({},e.attr)},t),function e(t){return t&&t.map((t,r)=>s.createElement(t.tag,c({key:r},t.attr),e(t.child)))}(e.child))}function d(e){var t=t=>{var r,{attr:a,size:n,title:l}=e,u=function(e,t){if(null==e)return{};var r,s,a=function(e,t){if(null==e)return{};var r={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;r[s]=e[s]}return r}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(s=0;s<n.length;s++)r=n[s],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}(e,o),d=n||t.size||"1em";return t.className&&(r=t.className),e.className&&(r=(r?r+" ":"")+e.className),s.createElement("svg",i({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,a,u,{className:r,style:c(c({color:e.color||t.color},t.style),e.style),height:d,width:d,xmlns:"http://www.w3.org/2000/svg"}),l&&s.createElement("title",null,l),e.children)};return void 0!==n?s.createElement(n.Consumer,null,e=>t(e)):t(a)}}},function(e){e.O(0,[956,473,971,117,744],function(){return e(e.s=3641)}),_N_E=e.O()}]);