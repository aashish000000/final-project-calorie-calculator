(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[220],{8058:function(e,t,r){Promise.resolve().then(r.bind(r,4384))},4384:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return h}});var s=r(7437),a=r(2265),n=r(9376),o=r(9501),c=r(3590),i=r(7119),l=r(7996),d=r(9116);let u=i.Ry({currentPassword:i.Z_().min(1,"Current password is required"),newPassword:i.Z_().min(6,"Password must be at least 6 characters"),confirmPassword:i.Z_()}).refine(e=>e.newPassword===e.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]});function h(){let e=(0,n.useRouter)(),[t,r]=(0,a.useState)(!1),[i,h]=(0,a.useState)(""),[m,g]=(0,a.useState)(""),[y,x]=(0,a.useState)(!1),[f,p]=(0,a.useState)(!1),[b,w]=(0,a.useState)(!1),{register:j,handleSubmit:N,reset:v,watch:P,formState:{errors:O}}=(0,o.cI)({resolver:(0,c.F)(u)}),S=P("newPassword",""),E=(e=>{if(!e)return{level:0,text:"",color:""};let t=0;return(e.length>=6&&t++,e.length>=8&&t++,/[A-Z]/.test(e)&&t++,/[0-9]/.test(e)&&t++,/[^A-Za-z0-9]/.test(e)&&t++,t<=2)?{level:t,text:"Weak",color:"bg-red-500"}:t<=3?{level:t,text:"Medium",color:"bg-yellow-500"}:{level:t,text:"Strong",color:"bg-green-500"}})(S),q=async e=>{r(!0),g(""),h("");try{await d.h.changePassword(e.currentPassword,e.newPassword),h("Password changed successfully!"),v(),setTimeout(()=>h(""),3e3)}catch(e){g(e instanceof Error?e.message:"Failed to change password")}finally{r(!1)}};return(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)("div",{className:"bg-white border-b border-gray-200 sticky top-16 z-40",children:(0,s.jsxs)("div",{className:"max-w-2xl mx-auto px-4 py-4 flex items-center gap-4",children:[(0,s.jsx)("button",{onClick:()=>e.back(),className:"p-2 -ml-2 hover:bg-gray-100 rounded-full transition-colors",children:(0,s.jsx)(l.Ao2,{className:"w-6 h-6 text-gray-700"})}),(0,s.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"Password & Security"})]})}),(0,s.jsxs)("div",{className:"max-w-2xl mx-auto px-4 py-6 space-y-6",children:[i&&(0,s.jsxs)("div",{className:"p-4 bg-green-50 border border-green-200 text-green-700 rounded-xl flex items-center gap-3",children:[(0,s.jsx)(l.UgA,{className:"w-5 h-5"}),i]}),m&&(0,s.jsxs)("div",{className:"p-4 bg-red-50 border border-red-200 text-red-700 rounded-xl flex items-center gap-3",children:[(0,s.jsx)(l.bcx,{className:"w-5 h-5"}),m]}),(0,s.jsx)("div",{className:"bg-gradient-to-r from-green-500 to-emerald-600 rounded-xl p-6 text-white",children:(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("div",{className:"w-12 h-12 bg-white/20 rounded-full flex items-center justify-center",children:(0,s.jsx)(l.bfl,{className:"w-6 h-6"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"font-semibold text-lg",children:"Your account is secure"}),(0,s.jsx)("p",{className:"text-green-100 text-sm",children:"Password encrypted with BCrypt"})]})]})}),(0,s.jsxs)("form",{onSubmit:N(q),className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[(0,s.jsxs)("div",{className:"p-4 border-b border-gray-100",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Change Password"}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Update your password to keep your account secure"})]}),(0,s.jsxs)("div",{className:"p-6 space-y-5",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Current Password"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("input",{...j("currentPassword"),type:y?"text":"password",className:"w-full px-4 py-3 pl-11 pr-11 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all",placeholder:"Enter current password"}),(0,s.jsx)(l.UIZ,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),(0,s.jsx)("button",{type:"button",onClick:()=>x(!y),className:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:y?(0,s.jsx)(l.rzC,{className:"w-5 h-5"}):(0,s.jsx)(l.rDJ,{className:"w-5 h-5"})})]}),O.currentPassword&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:O.currentPassword.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"New Password"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("input",{...j("newPassword"),type:f?"text":"password",className:"w-full px-4 py-3 pl-11 pr-11 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all",placeholder:"Enter new password"}),(0,s.jsx)(l.UIZ,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),(0,s.jsx)("button",{type:"button",onClick:()=>p(!f),className:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:f?(0,s.jsx)(l.rzC,{className:"w-5 h-5"}):(0,s.jsx)(l.rDJ,{className:"w-5 h-5"})})]}),O.newPassword&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:O.newPassword.message}),S&&(0,s.jsxs)("div",{className:"mt-2",children:[(0,s.jsx)("div",{className:"flex gap-1 mb-1",children:[1,2,3,4,5].map(e=>(0,s.jsx)("div",{className:"h-1 flex-1 rounded-full ".concat(e<=E.level?E.color:"bg-gray-200")},e))}),(0,s.jsxs)("p",{className:"text-xs ".concat(E.level<=2?"text-red-600":E.level<=3?"text-yellow-600":"text-green-600"),children:["Password strength: ",E.text]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm New Password"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("input",{...j("confirmPassword"),type:b?"text":"password",className:"w-full px-4 py-3 pl-11 pr-11 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all",placeholder:"Confirm new password"}),(0,s.jsx)(l.UIZ,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),(0,s.jsx)("button",{type:"button",onClick:()=>w(!b),className:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:b?(0,s.jsx)(l.rzC,{className:"w-5 h-5"}):(0,s.jsx)(l.rDJ,{className:"w-5 h-5"})})]}),O.confirmPassword&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:O.confirmPassword.message})]})]}),(0,s.jsx)("div",{className:"p-4 bg-gray-50 border-t border-gray-100",children:(0,s.jsx)("button",{type:"submit",disabled:t,className:"w-full py-3 px-4 bg-green-600 text-white font-semibold rounded-xl hover:bg-green-700 focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:t?"Changing Password...":"Change Password"})})]}),(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[(0,s.jsx)("h3",{className:"font-semibold text-gray-900 mb-4",children:"Security Tips"}),(0,s.jsxs)("ul",{className:"space-y-3 text-sm text-gray-600",children:[(0,s.jsxs)("li",{className:"flex items-start gap-2",children:[(0,s.jsx)(l.UgA,{className:"w-4 h-4 text-green-500 mt-0.5 flex-shrink-0"}),"Use at least 8 characters with uppercase, lowercase, and numbers"]}),(0,s.jsxs)("li",{className:"flex items-start gap-2",children:[(0,s.jsx)(l.UgA,{className:"w-4 h-4 text-green-500 mt-0.5 flex-shrink-0"}),"Don't reuse passwords from other accounts"]}),(0,s.jsxs)("li",{className:"flex items-start gap-2",children:[(0,s.jsx)(l.UgA,{className:"w-4 h-4 text-green-500 mt-0.5 flex-shrink-0"}),"Change your password regularly"]}),(0,s.jsxs)("li",{className:"flex items-start gap-2",children:[(0,s.jsx)(l.UgA,{className:"w-4 h-4 text-green-500 mt-0.5 flex-shrink-0"}),"Never share your password with anyone"]})]})]})]})]})}},9116:function(e,t,r){"use strict";r.d(t,{h:function(){return o}});var s=r(4131);let a=r(257).env.NEXT_PUBLIC_API_URL||"http://localhost:5000/api";class n{getToken(){return s.Z.get("token")}async request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.getToken(),s={"Content-Type":"application/json",...r&&{Authorization:"Bearer ".concat(r)},...t.headers},n=await fetch("".concat(a).concat(e),{...t,headers:s,credentials:"include"});if(!n.ok)throw Error((await n.json().catch(()=>({}))).message||"HTTP error! status: ".concat(n.status));return 204===n.status?{}:n.json()}async register(e){return this.request("/auth/register",{method:"POST",body:JSON.stringify(e)})}async login(e,t){return this.request("/auth/login",{method:"POST",body:JSON.stringify({email:e,password:t})})}async getCurrentUser(){return this.request("/auth/me")}async getFoods(){return this.request("/foods")}async getFood(e){return this.request("/foods/".concat(e))}async createFood(e){return this.request("/foods",{method:"POST",body:JSON.stringify(e)})}async updateFood(e,t){return this.request("/foods/".concat(e),{method:"PUT",body:JSON.stringify(t)})}async deleteFood(e){return this.request("/foods/".concat(e),{method:"DELETE"})}async getEntries(e){return this.request("/food-entries".concat(e?"?date=".concat(e):""))}async createEntry(e){return this.request("/food-entries",{method:"POST",body:JSON.stringify(e)})}async updateEntry(e,t){return this.request("/food-entries/".concat(e),{method:"PUT",body:JSON.stringify(t)})}async deleteEntry(e){return this.request("/food-entries/".concat(e),{method:"DELETE"})}async getDailyMetrics(e){return this.request("/metrics/daily".concat(e?"?date=".concat(e):""))}async getRangeMetrics(e,t){return this.request("/metrics/range?from=".concat(e,"&to=").concat(t))}async sendChatMessage(e,t){let r=null==t?void 0:t.map(e=>({sender:e.role,text:e.content}));return this.request("/chat",{method:"POST",body:JSON.stringify({message:e,history:r})})}async getGoals(){return this.request("/auth/goals")}async updateGoals(e){return this.request("/auth/goals",{method:"PUT",body:JSON.stringify(e)})}async updateProfile(e){return this.request("/auth/profile",{method:"PUT",body:JSON.stringify(e)})}async changePassword(e,t){return this.request("/auth/change-password",{method:"PUT",body:JSON.stringify({currentPassword:e,newPassword:t})})}async deleteAccount(){return this.request("/auth/account",{method:"DELETE"})}async uploadProfilePicture(e){return this.request("/auth/profile-picture",{method:"POST",body:JSON.stringify({imageData:e})})}async removeProfilePicture(){return this.request("/auth/profile-picture",{method:"DELETE"})}async analyzeFood(e){let t=new FormData;t.append("image",e);let r=this.getToken(),s=await fetch("".concat(a,"/image-recognition/analyze"),{method:"POST",headers:{...r&&{Authorization:"Bearer ".concat(r)}},body:t,credentials:"include"});if(!s.ok)throw Error((await s.json().catch(()=>({}))).message||"HTTP error! status: ".concat(s.status));return s.json()}async analyzeRecipe(e,t){return this.request("/recipe/analyze",{method:"POST",body:JSON.stringify({recipeText:e,servings:t})})}async getWaterSummary(e){return this.request("/water/summary".concat(e?"?date=".concat(e):""))}async logWater(e,t){return this.request("/water/log",{method:"POST",body:JSON.stringify({milliliters:e,date:t})})}async deleteWaterEntry(e){return this.request("/water/".concat(e),{method:"DELETE"})}async getFavoriteMeals(){return this.request("/favorite-meals")}async createFavoriteMeal(e){return this.request("/favorite-meals",{method:"POST",body:JSON.stringify(e)})}async deleteFavoriteMeal(e){return this.request("/favorite-meals/".concat(e),{method:"DELETE"})}async getFavoriteMealItems(e){return this.request("/favorite-meals/".concat(e,"/items"))}async getFoodSuggestions(e){return this.request("/suggestions".concat(e?"?date=".concat(e):""))}}let o=new n},9376:function(e,t,r){"use strict";var s=r(5475);r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}})},6231:function(e,t,r){"use strict";r.d(t,{w_:function(){return d}});var s=r(2265),a={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},n=s.createContext&&s.createContext(a),o=["attr","size","title"];function c(){return(c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e}).apply(this,arguments)}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach(function(t){var s,a;s=t,a=r[t],(s=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t||"default");if("object"!=typeof s)return s;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(s))in e?Object.defineProperty(e,s,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[s]=a}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function d(e){return t=>s.createElement(u,c({attr:l({},e.attr)},t),function e(t){return t&&t.map((t,r)=>s.createElement(t.tag,l({key:r},t.attr),e(t.child)))}(e.child))}function u(e){var t=t=>{var r,{attr:a,size:n,title:i}=e,d=function(e,t){if(null==e)return{};var r,s,a=function(e,t){if(null==e)return{};var r={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;r[s]=e[s]}return r}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(s=0;s<n.length;s++)r=n[s],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}(e,o),u=n||t.size||"1em";return t.className&&(r=t.className),e.className&&(r=(r?r+" ":"")+e.className),s.createElement("svg",c({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,a,d,{className:r,style:l(l({color:e.color||t.color},t.style),e.style),height:u,width:u,xmlns:"http://www.w3.org/2000/svg"}),i&&s.createElement("title",null,i),e.children)};return void 0!==n?s.createElement(n.Consumer,null,e=>t(e)):t(a)}}},function(e){e.O(0,[956,473,971,117,744],function(){return e(e.s=8058)}),_N_E=e.O()}]);